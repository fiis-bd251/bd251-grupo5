# 7.1. Creación de Tablas

 
```sql

DROP TABLE IF EXISTS EventoEntrega CASCADE;
DROP TABLE IF EXISTS Asignacion_transporte CASCADE;
DROP TABLE IF EXISTS Carga CASCADE;
DROP TABLE IF EXISTS RecepcionOrdenes CASCADE;
DROP TABLE IF EXISTS Conductores CASCADE;
DROP TABLE IF EXISTS Vehiculo CASCADE;
DROP TABLE IF EXISTS Cliente CASCADE;
DROP TABLE IF EXISTS evidencia CASCADE;
DROP TABLE IF EXISTS reclamo CASCADE;

DROP TYPE IF EXISTS estado_reclamo_enum CASCADE;
DROP TYPE IF EXISTS tipo_reclamo_enum CASCADE;
DROP TYPE IF EXISTS tipo_evidencia_enum CASCADE;
DROP TYPE IF EXISTS tipo_archivo_enum CASCADE;

--Creacion de types

CREATE TYPE estado_reclamo_enum AS ENUM (
    'solucionado', 
    'en pausa', 
    'en proceo',
    'rechazado'
);

CREATE TYPE tipo_reclamo_enum AS ENUM (
    'producto mal estado', 
    'producto equivocado', 
    'pedido incompleto',
    'no llegó el producto'  
);
CREATE TYPE tipo_evidencia_enum AS ENUM (
    'I',  -- Imagen
    'V',  -- Video
    'A',  -- Audio
    'D'   -- Documento
);

CREATE TYPE tipo_archivo_enum AS ENUM (
    'jpg',
    'png',
    'pdf',
    'mp4',
    'mp3'
);


-- Creación de las tablas
CREATE TABLE Cliente (
    id_cliente UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    direccion VARCHAR(200) NOT NULL,
    telefono VARCHAR(20),
    email VARCHAR(100),
    fecha_registro TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Vehiculo (
    id_vehiculo UUID DEFAULT gen_random_uuid() PRIMARY KEY
);

CREATE TABLE Conductores (
    id_conductor UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    DNI UUID DEFAULT gen_random_uuid(),
    nombre_conductor VARCHAR(100) NOT NULL,
    telefono_conductor VARCHAR(9) NOT NULL,
    licencia_conductor VARCHAR(20) NOT NULL,
    estado_conductor BOOLEAN DEFAULT TRUE,
    vehiculo_asignado VARCHAR(20),
    fecha_registro TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Asignacion_transporte (
    id_asignacion UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    id_vehiculo UUID NOT NULL REFERENCES Vehiculo(id_vehiculo),
    id_conductor UUID NOT NULL REFERENCES Conductores(id_conductor)
);

CREATE TABLE Carga (
    id_carga UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    id_vehiculo UUID NOT NULL REFERENCES Vehiculo(id_vehiculo)
);

CREATE TABLE RecepcionOrdenes (
    id_orden UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    codigo_orden VARCHAR(20) NOT NULL UNIQUE,
    tipo_orden VARCHAR(10) CHECK (tipo_orden IN ('AVICOLA', 'CONSUMO', 'MIXTA')),
    fecha_creacion TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,
    prioridad SMALLINT CHECK (prioridad BETWEEN 1 AND 5),
    cliente_id UUID NOT NULL
);


CREATE TABLE EventoEntrega (
    id_entrega UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    id_orden UUID NOT NULL REFERENCES RecepcionOrdenes(id_orden),
    id_conductor UUID NOT NULL REFERENCES Conductores(id_conductor),
    fecha_entrega TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,
    estado_entrega VARCHAR(20) NOT NULL CHECK (estado_entrega IN (
        'completada', 
        'fallida', 
        'con_reclamo',
        'reprogramada'
    )),
    firma_cliente VARCHAR(255),
    evidencia VARCHAR(255),
    observaciones VARCHAR(200)
    
);


CCREATE TABLE reclamo (
    id_reclamo UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    id_entrega UUID NOT NULL REFERENCES EventoEntrega(id_entrega),
    id_cliente UUID NOT NULL REFERENCES cliente(id_cliente),
    descripcion TEXT,
    fecha_reclamo TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,
    estado estado_reclamo_enum NOT NULL,
    tipo_reclamo tipo_reclamo_enum NOT NULL,
    FOREIGN KEY (id_entrega) REFERENCES EventoEntrega(id_entrega)
);


CREATE TABLE IF NOT EXISTS evidencia (
    id_evidencia UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    id_reclamo UUID NOT NULL REFERENCES reclamo(id_reclamo),
    tipo_evidencia tipo_evidencia_enum NOT NULL,
    tipo_archivo tipo_archivo_enum NOT NULL,
    nombre_evidencia VARCHAR(60) DEFAULT NULL
);


```
