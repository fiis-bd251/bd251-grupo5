# 5.2. Diccionario de Datos

---

## 🔷 Tablas Principales

### `ordenes_entrega`
Registra las órdenes de entrega solicitadas.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador único de la orden                     |
| fecha_solicitud  | DATE             | Fecha en que se solicita la orden                    |
| fecha_entrega    | DATE             | Fecha programada de entrega                          |
| prioridad_id     | INT              | FK a `prioridades`                                   |
| origen           | TEXT             | Punto de partida del producto                        |
| destino          | TEXT             | Punto de entrega del producto                        |
| tipo_carga_id    | INT              | FK a `tipos_carga`                                   |

---

### `plan_entrega`
Planes de entrega generados a partir de las órdenes.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador único del plan                        |
| orden_id         | INT              | FK a `ordenes_entrega`                              |
| fecha_plan       | DATE             | Fecha de creación del plan                           |
| fecha_entrega    | DATE             | Fecha programada de entrega                          |
| estado_id        | INT              | FK a `estados_plan`                                  |
| empleado_id      | INT              | FK a tabla de empleados (no detallada aquí)          |

---

### `direccion_plan`
Direcciones específicas incluidas en un plan.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador                                        |
| plan_id          | INT              | FK a `plan_entrega`                                 |
| cliente_id       | INT              | FK a tabla de clientes                               |
| orden            | INTEGER          | Secuencia en el recorrido                            |

---

### `producto_plan`
Productos incluidos por dirección.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador                                        |
| direccion_plan_id| INT              | FK a `direccion_plan`                               |
| producto_id      | INT              | FK a tabla de productos                              |
| cantidad         | NUMERIC(10,2)    | Cantidad de unidades a entregar                      |

---

### `ruta`
Rutas utilizadas para las entregas.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador de la ruta                             |
| tipo_vehiculo_id | INT              | FK a `tipos_vehiculo`                                |
| refrigeracion    | BOOLEAN          | Si requiere refrigeración (TRUE/FALSE)              |

---

### `vehiculo`
Vehículos disponibles para transporte.

| Campo               | Tipo de Dato     | Descripción                                          |
|--------------------|------------------|------------------------------------------------------|
| id                 | SERIAL PRIMARY KEY | Identificador del vehículo                          |
| placa              | VARCHAR(10)      | Número de placa                                      |
| tipo_vehiculo_id   | INT              | FK a `tipos_vehiculo`                                |
| estado_vehiculo_id | INT              | FK a `estados_vehiculo`                              |
| capacidad          | NUMERIC(10,2)    | Capacidad del vehículo (peso o volumen)              |

---

### `conductor`
Conductores asignables a vehículos.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador del conductor                         |
| nombre            | TEXT             | Nombre completo                                      |
| licencia          | VARCHAR(20)      | Número de licencia                                   |
| estado_id         | INT              | FK a `estados_conductor`                             |

---

### `asignacion_transporte`
Asigna vehículo y conductor a una ruta.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador                                        |
| cod_ruta         | INT              | FK a `ruta`                                          |
| placa            | INT              | FK a `vehiculo`                                      |
| cod_conductor    | INT              | FK a `conductor`                                     |
| fecha_asignacion | DATE             | Fecha en que se asigna                              |
| estado_asignacion| INT              | asignacion actual, como va                          |
| capacidad_utilizada| INT             |total de flota disponible                          |
| observaciones    | VARCHAR(60)      | problemas, imprevistos, paradas en ruta, etc         |
| cod_prioridad    | DATE             | FK a `conductor`                             |
| cod_despacho     | DATE             | FK a `conductor`                             |


---

### `Carga`

La entidad Carga representa los productos o bienes físicos que serán transportados desde un punto de origen a un punto de destino.

| Campo               | Tipo de Dato       | Descripción                              |
|---------------------|--------------------|------------------------------------------|
| id_carga            | UUID               | Identificador de la carga                |
| fecha_carga         | DATE               | Fecha en que se despacha                 |
| hora_carga          | TIME               | Hora en que se despacha                  |
| estado_carga_id     | INT                | FK a `estado_carga`                      |
| Sku_id              | INT                | FK a `Sku`                               |
| temperatura         | NUMERIC(4,2)       | Temperatura en °C                        |
| canal_de_atención_id| INT                | FK a `canal_de_atención`                 |
| hub_id              | INT                | FK a `hub`                               |
|tipo_producto_id     | INT                | FK a `tipo_producto`                     |            


---

### `calidad`
La entidad de Calidad se encarga de verificar que el vehículo se encuentre en óptimas condiciones antes de iniciar el recorrido de distribución.

| Campo               | Tipo de Dato       | Descripción                                                 |
|---------------------|--------------------|-------------------------------------------------------------|
| id_calidad          | UUID               | Identificador de la verificación de calidad del vehiculo    |
| id_usuario          | FOREIGN KEY        | Identificador del personal encargado de verificar la calidad|
| fecha_verificacion  | DATE               | Fecha en que se verifica la temperatura del vehiculo        |
| hora_verificacion   | TIME               | Hora en que se verifica la temperatura del vehiculo         |
| temperatura_vehiculo| NUMERIC(4,2)       | Temperatura en °C                                           |

---

### `monitoreo_ruta`
Monitoreo de la entrega en tiempo real.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador del monitoreo                         |
| despacho_id      | INT              | FK a `despacho_carga`                               |
| fecha            | DATE             | Fecha del monitoreo                                  |
| hora             | TIME             | Hora del monitoreo                                   |
| ubicacion_actual | TEXT             | Coordenadas o descripción textual                   |
| estado_vehiculo  | TEXT             | Estado actual del vehículo                          |
| incidencias      | TEXT             | Descripción de problemas                            |

---

### `Evento_entrega`
Registro del evento de entrega.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id_entrega               | VARCHAR(20) | Identificador                                        |
| id_conductor     | VARCHAR(20)              | FK a Conductor                               |
| id_orden     | VARCHAR(20)              | FK a Orden                              |
| fecha_entrega    | TIMESTAMP             | Fecha y hora de entrega                                     |
| firma_cliente    | VARCHAR(255)             | URL de AWS S3 donde se almacena la firma                     |
| foto_evidencia   | VARCHAR(255)             | URL de AWS S3 donde se almacena la evidencia                                      |
| observaciones    | VARCHAR(255)             | Comentarios adicionales  del conductor                           |
| id_incidencia    | VARCHAR(20)            | Se obtiene del módulo de Reclamos si se genera reclamo             |

Ejemplo de firma_cliente y foto_evidencia en un envío de reclamo al módulo de Reclamos en formato JSON:

    {
      "evento_type": "reclamo_registrado",
      "origen": "control_entrega",
      "payload": {
        "id_orden": "ORD-001",
        "observaciones": "5 kg de pollo con mal olor",
        "foto_evidencia": "https://bucket.s3.amazonaws.com/evidencias/ORD-001.jpg",
        "firma_cliente": "https://bucket.s3.amazonaws.com/firmas/ORD-001.svg"
      }
    }

---

### `reclamo`
Reclamos generados por entregas.

| Campo             | Tipo de Dato     | Descripción                                          |
|------------------|------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador del reclamo                           |
| entrega_id       | INT              | FK a `entrega`                                       |
| tipo_reclamo_id  | INT              | FK a `tipos_reclamo`                                 |
| fecha_reclamo    | DATE             | Fecha de creación del reclamo                        |
| estado_reclamo_id| INT              | FK a `estados_reclamo`                               |
| fecha_resolucion | DATE             | Fecha en que se resolvió el reclamo (nullable)      |

---
### `evidencia`  
Archivos asociados como evidencia de eventos del proceso logístico.

| Campo            | Tipo de Dato       | Descripción                                          |
|------------------|--------------------|------------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador único de la evidencia                  |
| descripcion      | VARCHAR(255)       | Descripción breve del contenido                      |
| tipo_id          | INT                | FK a tipos_evidencia                                 |
| tipo_archivo_id  | INT                | FK a tipos_archivo                                   |

---

### `cliente`  
Clientes registrados en el sistema.

| Campo            | Tipo de Dato       | Descripción                                     |
|------------------|--------------------|-------------------------------------------------|
| id               | SERIAL PRIMARY KEY | Identificador único del cliente                 |
| nombre           | VARCHAR(100)       | Nombre o razón social del cliente               |
| direccion        | VARCHAR(150)       | Dirección fiscal o de entrega                   |
| fecha_registro   | DATE               | Fecha de registro del cliente                   |
| estado_id        | INT                | FK a estados_cliente                            |
| tipo_cliente_id  | INT                | FK a tipos_cliente                              |

---


## 🔸 Lookup Tables (Tablas de Referencia)

Estas tablas definen valores controlados para campos del sistema.

### `prioridades`
| id | descripcion |
|----|-------------|
| 1  | Alta        |
| 2  | Media       |
| 3  | Baja        |

### `tipos_carga`
| id | descripcion      |
|----|------------------|
| 1  | Perecible        |
| 2  | Frágil           |
| 3  | Peligrosa        |

### `estados_plan`, `estados_entrega`, `estados_carga`, `estados_conductor`, `estados_vehiculo`, `estados_reclamo`
| id | descripcion      |
|----|------------------|
| 1  | planificado / completa / activo / abierto, etc. |

> ⚠️ Cada estado se modela con una tabla distinta, según el contexto.

### `tipos_vehiculo`
| id | descripcion |
|----|-------------|
| 1  | Camión      |
| 2  | Furgoneta   |
| 3  | Mototaxi    |

### `tipos_reclamo`
| id | descripcion         |
|----|---------------------|
| 1  | Entrega tardía      |
| 2  | Producto dañado     |
| 3  | Faltante            |

---

