# 6.2. Par√°metros f√≠sicos

---

## üî∑ Tablas Principales

### `ordenes_entrega`

#### **Configuraci√≥n de Almacenamiento**

| **Par√°metro**                       | **Valor**            | **Justificaci√≥n**                   |
|-------------------------------------|----------------------|-------------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE)    | 8 KB                 | √ìptimo para registros medianos     |
| Tama√±o de extent inicial            | 64 KB (8 bloques)    | Para crecimiento controlado de la tabla |
| Espacio libre reservado (PCTFREE)   | 10%                  | Para reducir la necesidad de migraci√≥n |

#### **Estructura del Registro y Tama√±o L√≥gico**

| **Atributo**        | **Tipo de Dato**      | **Tama√±o (Bytes)** | **Notas**                  |
|---------------------|-----------------------|--------------------|----------------------------|
| cod_orden           | UUID                  | 16                 | PK                         |
| destino             | VARCHAR(255)          | 255                |                            |
| origen              | VARCHAR(255)          | 255                |                            |
| fecha_orden         | DATE                  | 8                  |                            |
| hora_orden          | TIME                  | 8                  |                            |
| descripcion         | TEXT                  | 500                |                            |
| cod_cliente         | UUID                  | 16                 | FK                         |
| cod_prioridad       | UUID                  | 16                 | FK                         |
| fecha_creacion      | TIMESTAMPTZ           | 8                  |                            |
| fecha_actualizacion | TIMESTAMPTZ           | 8                  |                            |

#### **Tama√±o Total - F√≥rmulas**

1. **Espacio Libre por Bloque**:
   - Tama√±o de bloque = 8 KB = 8192 bytes.
   - Sobrecarga de bloque = 107 bytes (esto puede variar dependiendo de la implementaci√≥n exacta de PostgreSQL, pero es un valor aproximado com√∫n).
   - Espacio libre por bloque = \( (8192 - 107) \times (1 - 0.10) = 7276.5 \) bytes por bloque.

2. **Cantidad de Filas por Bloque**:
   Para calcular el espacio ocupado por cada registro, sumamos los tama√±os de los atributos:
   - **cod_orden**: 16 bytes
   - **destino**: 255 bytes
   - **origen**: 255 bytes
   - **fecha_orden**: 8 bytes
   - **hora_orden**: 8 bytes
   - **descripcion**: 500 bytes
   - **cod_cliente**: 16 bytes
   - **cod_prioridad**: 16 bytes
   - **fecha_creacion**: 8 bytes
   - **fecha_actualizacion**: 8 bytes

   Total por registro:  
   \( 16 + 255 + 255 + 8 + 8 + 500 + 16 + 16 + 8 + 8 = 1090 \) bytes por registro.

   **Cantidad de Filas por Bloque**:  
   \( \frac{7276.5}{1090} \approx 6.67 \), redondeado a 6 filas por bloque.

3. **Cantidad de Bloques**:
   Si proyectamos una cantidad de **19,636** registros (como en el ejemplo de la tabla **plan_entrega**), la cantidad de bloques necesarios ser√°:
   \[
   \frac{19,636}{6} \approx 3273 \text{ bloques}
   \]

4. **Tama√±o Total**:
   \[
   \text{Tama√±o Total} = 3273 \times 8192 = 26,804,736 \text{ bytes} = 26.8 \text{ MB}



### `plan_entrega`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                   |
|-----------------------------------|----------------------|---------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Optimo para registros medianos  |
| Tama√±o de extent inicial          | 64 KB (8 bloques)    | Para crecimiento controlado de la tabla    |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migraci√≥n        |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo         | Tipo de Dato          | Tama√±o (Bytes)    | Notas                     |
|------------------|-----------------------|-------------------|---------------------------|
| id_plan          | UUID                  | 16                | PK                        | 
| id_usuario	   | UUID	               | 16                | FK                        |
| fecha_entrega	   | TIMESTAMPTZ       	   | 8                 | -                         |
| estado           | VARCHAR(15)           | 15                | -                         |
| fecha_plan	   | TIMESTAMPTZ  	       | 8                 | -                         |

#### Tama√±o Total - F√≥rmulas

- Espacio Libre por Bloque = (Tama√±o de Bloque - Sobrecarga de Bloque) * Factor = (8 * 1024 - 107) * (1-10%) = 7276,5 bytes por bloque
- Cantidad de Filas por Bloque = 7276,5 / 63 = 115.5 = 116 filas por bloque
- Cantidad de Bloques = 19,636 / 116 =  169.27 = 170 Bloques
- Tama√±o Total = Cantidad de Bloques * Tama√±o de Bloque = 170 * 8 * 1024 = 1,392,640 bytes = 1,360 Kb = 1.33 Mb

### `ruta`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                   |
|-----------------------------------|----------------------|---------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Optimo para registros medianos  |
| Tama√±o de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migraci√≥n        |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo        | Tipo de Dato   | Tama√±o (bytes) | Notas                   |
|------------------|---------------|----------------|-------------------------|
| id_ruta          | UUID          | 16             | Identificador principal.|
| id_plan          | UUID          | 16             | FK		              |
| fecha_hora_salida      | TIMESTAMPTZ   | 8              | -                       |
| fecha_hora_regreso     | TIMESTAMPTZ   | 8              | -                       |

#### Tama√±o Total - F√≥rmulas

- Espacio Libre por Bloque = (8 * 1024 - 107) * (1-10%) = 7276,5 bytes por bloque
- Cantidad de Filas por Bloque = 7276,5 / 48 = 151.59 = 152 filas por bloque
- Cantidad de Bloques = 54,000 / 152 =  355.26 = 356 Bloques
- Tama√±o Total = 356 * 8 * 1024 = 2,916,352 bytes = 2,848 Kb = 2.78 Mb

### `direccion_plan`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                   |
|-----------------------------------|----------------------|---------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Valor por defecto en PostgreSQL compilado  |
| Tama√±o de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migraci√≥n        |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo         | Tipo de Dato | Tama√±o (bytes) | Notas                   |
|------------------|--------------|----------------|-------------------------|
| id_dir_plan      | UUID         | 16             | Identificador fijo      |
| id_ruta          | UUID         | 16             | FK                      |
| cod_orden        | UUID         | 16             | FK                      |
| posicion_dir     | NUMERIC(5)   | 5              | -                       |
| latitud_dir      | DOUBLE PRECISION| 8           | -                       |
| longitud_dir     | DOUBLE PRECISION| 8           | -                       |

#### Tama√±o Total - F√≥rmulas

- Espacio Libre por Bloque = (8 * 1024 - 107) * (1-10%) = 7276.5 bytes por bloque
- Cantidad de Filas por Bloque = (7276.5) / 69 = 105.45 = 106 filas por bloque
- Cantidad de Bloques = 479,260 / 106 =  4,521.32 = 4,522 Bloques
- Tama√±o Total = 4,522 * 8 * 1,024 = 37,044,224 bytes = 36,176 Kb = 35.33 Mb

### `Evento_Entrega`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                   |
|-----------------------------------|----------------------|---------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Optimo para registros medianos  |
| Tama√±o de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migraci√≥n        |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo         | Tipo de Dato          | Tama√±o (Bytes)    | Notas                     |
|------------------|-----------------------|-------------------|---------------------------|
| id_entrega       | UUID                 | 16                | UUID                      | 
| id_orden         | UUID      	       | 16                | FK                        |
| id_conductor     | UUID      	       | 16                | FK                        |
| fecha_entrega    | TIMESTAMPTZ	       | 8                | -                         |
| estado_entrega   | VARCHAR(20)	       | 21                | -                         |
| firma_cliente    | VARCHAR(255)	       | 259               | URL de S3 para firma.                   |
| evidencia        | VARCHAR(255)	       | 259               | URL de S3 para firma.                   |
| id_reclamo       | UUID       	       | 16                | FK opcional a Gesti√≥n de Reclamos       |
| observaciones    | VARCHAR(200)	       | 204               | Campo opcional de haber reclamo         |
| Overhead de fila | -	                   | 23                | Cabecera de fila PostgreSQL       |
| Total por registro | -	               | 838               | Suma de columnas + Overhead   |

#### Tama√±o Total - F√≥rmulas

- Espacio Libre por Bloque = (Tama√±o de Bloque - Sobrecarga de Bloque) * Factor = (8 * 1024 - 24) * (0.9) = 7351,2 bytes por bloque
- Cantidad de Filas por Bloque = (Espacio Libre por Bloque) / (Tama√±o de Fila + Sobrecarga de Fila) = (7351,2) / (815 + 23) = 8,77 = 9 filas por bloque
- Cantidad de Bloques = Cantidad Total de Filas / Cantidad de Filas por Bloque = 52,416 / 9 = 5824 Bloques
- Tama√±o Total = Cantidad de Bloques * Tama√±o de Bloque = 5824 * 8 * 1024 = 45,50 Mb

---
### `Carga`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                            | Valor                | Justificaci√≥n                              |
|--------------------------------------|----------------------|--------------------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE)     | 8 KB                 | Optimo para registros medianos             |
| Espacio libre reservado (FILLFACTOR) | 80%                  | Para reducir necesidad de migraci√≥n        |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo         | Tipo de Dato          | Tama√±o (Bytes)    | Notas                     |
|------------------|-----------------------|-------------------|---------------------------|
| id_carga         | UUID                  | 16                | UUID                      | 
| fecha_carga      | DATE        	       | 4                 | -                         |
| hora_carga       | TIME        	       | 8                 | -                         |
| estado_carga     | VARCHAR(20)	       | 21                | -                         |
| sku              | VARCHAR(7)            | 8                 | -                         |
| temperatura      | NUMERIC(4,2)          | 4                 | -                         |
| canal_de_atenci√≥n| VARCHAR(12)           | 13                | -                         |
| hub              | VARCHAR(13)           | 14                | -                         |
| tipo_producto    | VARCHAR (8)           | 9                 | -                         |
| Overhead de fila | -	                   | 23                |Cabecera de fila PostgreSQL|
|Total por registro| -	                   | 120               |Suma de columnas + Overhead|

#### Tama√±o Total - F√≥rmulas

- Espacio Libre por Bloque = (Tama√±o de Bloque - Sobrecarga de Bloque) * Factor = (8 * 1024 - 24) * (0.8) = 6534.4 bytes por bloque
- Cantidad de Filas por Bloque = (Espacio Libre por Bloque) / (Tama√±o de Fila + Sobrecarga de Fila) = (6534.4) / (97 + 23) = 54.45 = 54 filas por bloque
- Cantidad de Bloques = Cantidad Total de Filas / Cantidad de Filas por Bloque = 157248 / 54 = 2912 Bloques
- Tama√±o Total = Cantidad de Bloques * Tama√±o de Bloque = 2912 * 8 * 1024 = 22.75 mb

---

### `Reclamo`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                                   |
|----------------------------------|----------------------|-------------------------------------------------|
| Tama√±o de bloque (`block_size`)  | 8 KB (8192 bytes)    | Valor por defecto en PostgreSQL compilado       |
| Tama√±o de extent inicial         | 64 KB (8 bloques)    | Buen punto de partida para crecimiento moderado |
| Espacio libre reservado (`fillfactor`) | 90% (10% libre) | Aumenta eficiencia de actualizaciones            |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo         | Tipo de Dato           | Tama√±o (Bytes) | Notas                                                |
|------------------|------------------------|----------------|------------------------------------------------------|
| id_reclamo     | UUID                   | 16             | Identificador principal                              |
| id_entrega     | UUID                   | 16             | Clave for√°nea a `EventoEntrega`                      |
| id_cliente     | UUID                   | 16             | Clave for√°nea a `cliente`                            |
| descripcion    | TEXT                   | ~200           | Promedio estimado de 200 caracteres                  |
| fecha_reclamo  | TIMESTAMPTZ            | 8              | Fecha y hora con zona horaria                        |
| estado         | estado_reclamo_enum`  | 4              | Enum interno almacenado como 4 bytes                 |
| tipo_reclamo   | tipo_reclamo_enum`    | 4              | Enum interno almacenado como 4 bytes                 |
| Overhead fila| -                      | 23             | Cabecera interna de PostgreSQL                       |
| Padding     | -                      | 1              | Alineamiento para m√∫ltiplos de 8                     |
| **Total por fila** | -                    | **288 bytes**  | Suma aproximada de todos los campos                  |


#### Tama√±o Total - F√≥rmulas

- PProyecci√≥n de registros al 2028 = 629 reclamos  
- Tama√±o del bloque = 8192 bytes  
- Uso efectivo del bloque = 90% ‚Üí 8192 * 0.9 = 7372.8 bytes  
- Filas por bloque = 7372.8 / 288 ‚âà 25 filas  
- Cantidad de bloques requeridos = 629 / 25 ‚âà 25.16 ‚Üí 26 bloques  
- Tama√±o total estimado = 26 * 8192 bytes = 213,000 bytes ‚âà 208 KB

### `Monitoreo_ruta`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                                               |
|----------------------------------|----------------------|-------------------------------------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE) | 8 KB (8192 bytes)    | Valor por defecto en PostgreSQL                            |
| Tama√±o de extent inicial         | 64 KB (8 bloques)    | Para lecturas secuenciales y crecimiento progresivo        |
| Espacio libre reservado (PCTFREE)| 10%                  | Previene migraciones por actualizaciones frecuentes         |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo              | Tipo de Dato         | Tama√±o (bytes) | Notas                              |
|-----------------------|----------------------|----------------|------------------------------------|
| id_monitoreo          | UUID                 | 16             | Clave primaria                     |
| id_asignacion         | UUID                 | 16             | Clave for√°nea                      |
| ubicacion_actual      | POINT                | 16             | Coordenadas geogr√°ficas            |
| velocidad             | DECIMAL(5,2)         | 8              | Velocidad promedio                 |
| temperatura_carga     | DECIMAL(5,2)         | 8              | Temperatura medida en ruta         |
| combustible_restante  | DECIMAL(5,2)         | 8              | Combustible disponible             |
| estado_compartimento  | VARCHAR(20)          | 21             | "cerrado", "abierto", etc.         |
| timestamp_registro    | TIMESTAMPTZ          | 8              | Fecha y hora de la medici√≥n        |
| distancia_recorrida   | DECIMAL(10,2)        | 8              | Distancia total recorrida          |
| tiempo_transcurrido   | INTERVAL             | 12             | Tiempo de viaje                    |
| Overhead fila         | -                    | 23             | Cabecera interna de PostgreSQL     |
| **Total estimado**    | -                    | **144 bytes**  | Sumatoria aproximada               |

#### Tama√±o Total - F√≥rmulas

- Espacio √∫til por bloque = (8192 - 24) * 0.9 = **7340.4 bytes**
- Filas por bloque = 7340.4 / 144 = **51 filas**
- Bloques necesarios para 5000 registros = 5000 / 51 ‚âà **99 bloques**
- Tama√±o total = 99 * 8192 = **811,008 bytes ‚âà 0.77 MB**

---

### `Incidencia`

#### Configuraci√≥n de Almacenamiento

| Par√°metro                         | Valor                | Justificaci√≥n                                         |
|----------------------------------|----------------------|-------------------------------------------------------|
| Tama√±o de bloque (DB_BLOCK_SIZE) | 8 KB (8192 bytes)    | Valor por defecto en PostgreSQL                      |
| Tama√±o de extent inicial         | 64 KB (8 bloques)    | Para vol√∫menes medianos de reclamos                  |
| Espacio libre reservado (PCTFREE)| 10%                  | Mejora eficiencia en inserciones y actualizaciones   |

#### Estructura del Registro y Tama√±o L√≥gico:

| Atributo           | Tipo de Dato         | Tama√±o (bytes) | Notas                                      |
|--------------------|----------------------|----------------|--------------------------------------------|
| id_incidencia      | UUID                 | 16             | Clave primaria                             |
| id_monitoreo       | UUID                 | 16             | Clave for√°nea                              |
| tipo_incidencia    | ENUM                 | 4              | Almacenado como 4 bytes                    |
| severidad          | ENUM                 | 4              | Almacenado como 4 bytes                    |
| descripcion        | TEXT                 | ~100           | Descripci√≥n de incidente                   |
| estado             | VARCHAR(20)          | 21             | Estado de resoluci√≥n                       |
| fecha_resolucion   | TIMESTAMPTZ          | 8              | Opcional                                   |
| acciones_tomadas   | TEXT                 | ~150           | Texto de acciones correctivas              |
| observaciones      | TEXT                 | ~100           | Texto adicional                            |
| Overhead fila      | -                    | 23             | Cabecera interna PostgreSQL                |
| **Total estimado** | -                    | **442 bytes**  | Tama√±o total aproximado por fila           |

#### Tama√±o Total - F√≥rmulas

- Espacio √∫til por bloque = (8192 - 24) * 0.9 = **7340.4 bytes**
- Filas por bloque = 7340.4 / 442 = **17 filas**
- Bloques necesarios para 2500 registros = 2500 / 17 ‚âà **147 bloques**
- Tama√±o total = 147 * 8192 = **1,204,224 bytes ‚âà 1.15 MB**

---
