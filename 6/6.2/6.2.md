# 6.2. Parámetros físicos

---

## 🔷 Tablas Principales

### `plan_entrega`

#### Configuración de Almacenamiento

| Parámetro                         | Valor                | Justificación                   |
|-----------------------------------|----------------------|---------------------------------|
| Tamaño de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Optimo para registros medianos  |
| Tamaño de extent inicial          | 64 KB (8 bloques)    | Para crecimiento controlado de la tabla    |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migración        |

#### Estructura del Registro y Tamaño Lógico:

| Atributo         | Tipo de Dato          | Tamaño (Bytes)    | Notas                     |
|------------------|-----------------------|-------------------|---------------------------|
| cod_plan         | CHAR(20)              | 20                | PK                        | 
| cod_empleado	   | VARCHAR2(20)	       | 20                | FK                        |
| fecha_entrega	   | DATE       	       | 7                 | -                         |
| estado           | VARCHAR(15)           | 15                | -                         |
| fecha_plan	   | TIMESTAMP  	       | 11                | -                         |

#### Tamaño Total - Fórmulas

- Espacio Libre por Bloque = (Tamaño de Bloque - Sobrecarga de Bloque) * Factor = (8 * 1024 - 107) * (1-10%) = 7276,5 bytes por bloque
- Cantidad de Filas por Bloque = (Espacio Libre por Bloque) / (Tamaño de Fila + Sobrecarga de Fila) = (7276,5) / (73) = 99.68 = 99 filas por bloque
- Cantidad de Bloques = Cantidad Total de Filas / Cantidad de Filas por Bloque = 19,636 / 99 =  198.34 = 198 Bloques
- Tamaño Total = Cantidad de Bloques * Tamaño de Bloque = 198 * 8 * 1024 = 1,622,016 bytes = 1,584 Kb = 1.55 Mb

### `ruta`

#### Configuración de Almacenamiento

| Parámetro                         | Valor                | Justificación                   |
|-----------------------------------|----------------------|---------------------------------|
| Tamaño de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Optimo para registros medianos  |
| Tamaño de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migración        |

#### Estructura del Registro y Tamaño Lógico:

| Atributo        | Tipo de Dato   | Tamaño (bytes) | Notas                   |
|------------------|---------------|----------------|-------------------------|
| id_ruta          | CHAR(20)      | 20             | Identificador principal.|
| id_plan          | CHAR(20)      | 20             | FK		      |
| volumen_total    | NUMBER(10,2)  | 7              | -                       |
| peso_total       | NUMBER(10,2)  | 7              | -                       |
| refrigeración    | NUMBER(4,1)   | 4              | -                       |
| hora_salida      | DATE          | 7              | -                       |
| hora_regreso     | DATE          | 7              | -                       |
| fecha_salida     | DATE          | 7              | -                       |                                                          |

#### Tamaño Total - Fórmulas

- Espacio Libre por Bloque = (Tamaño de Bloque - Sobrecarga de Bloque) * Factor = (8 * 1024 - 107) * (1-10%) = 7276,5 bytes por bloque
- Cantidad de Filas por Bloque = (7276,5) / (59) = 123.33 = 123 filas por bloque
- Cantidad de Bloques = 54,000 / 123 =  439.02 = 440 Bloques
- Tamaño Total = 440 * 8 * 1024 = 3,604,480 bytes = 3,520 Kb = 3.44 Mb

### `direccion_plan`

#### Configuración de Almacenamiento

| Parámetro                         | Valor                | Justificación                   |
|-----------------------------------|----------------------|---------------------------------|
| Tamaño de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Valor por defecto en PostgreSQL compilado  |
| Tamaño de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migración        |

#### Estructura del Registro y Tamaño Lógico:

| Atributo         | Tipo de Dato | Tamaño (bytes) | Notas                   |
|------------------|--------------|----------------|-------------------------|
| id_dir_plan      | CHAR(20)     | 20             | Identificador fijo      |
| orden            | NUMBER(5)    | 3              | -                       |
| cod_orden        | CHAR(20)     | 20             | FK                      |

#### Tamaño Total - Fórmulas

- Espacio Libre por Bloque = (8 * 1024 - 107) * (1-10%) = 7276,5 bytes por bloque
- Cantidad de Filas por Bloque = (7276,5) / (43) = 169.22 = 170 filas por bloque
- Cantidad de Bloques = 479,260 / 170 =  2,819.17 = 2,820 Bloques
- Tamaño Total = 2,820 * 8 * 1,024 = 23,101,440 bytes = 22,560 Kb = 22.03 Mb

### `producto_plan`

#### Configuración de Almacenamiento

| Parámetro                         | Valor                | Justificación                   |
|-----------------------------------|----------------------|---------------------------------|
| Tamaño de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Valor por defecto en PostgreSQL compilado  |
| Tamaño de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migración        |

#### Estructura del Registro y Tamaño Lógico:

| Atributo     | Tipo de Dato | Tamaño (bytes) | Notas                          |
|--------------|--------------|----------------|--------------------------------|
| id_producto  | CHAR(20)     | 20             | Identificador del producto     |
| cantidad     | NUMBER(6)    | ~3             | -     				|

#### Tamaño Total - Fórmulas

- Espacio Libre por Bloque = (8 * 1024 - 107) * (1-10%) = 7276,5 bytes por bloque
- Cantidad de Filas por Bloque = (7276,5) / (23) = 316.37 = 317 filas por bloque
- Cantidad de Bloques = 5,130,000 / 317 =  16,182.96 = 16,183 Bloques
- Tamaño Total = 16,183 * 8 * 1,024 = 132,571,136 bytes = 129,464 Kb = 126.43 Mb

### `Evento_Entrega`

#### Configuración de Almacenamiento

| Parámetro                         | Valor                | Justificación                   |
|-----------------------------------|----------------------|---------------------------------|
| Tamaño de bloque (DB_BLOCK_SIZE)  | 8 KB                 | Optimo para registros medianos  |
| Tamaño de extent inicial          | 64 KB (8 bloques)    | Para tablas con crecimiento constante      |
| Espacio libre reservado (PCTFREE) | 10%                  | Para reducir necesidad de migración        |

#### Estructura del Registro y Tamaño Lógico:

| Atributo         | Tipo de Dato          | Tamaño (Bytes)    | Notas                     |
|------------------|-----------------------|-------------------|---------------------------|
| id_entrega       | UUID                 | 16                | UUID                      | 
| id_orden         | UUID      	       | 16                | FK                        |
| id_conductor     | UUID      	       | 16                | FK                        |
| fecha_entrega    | TIMESTAMPTZ	       | 8                | -                         |
| estado_entrega   | VARCHAR(20)	       | 21                | -                         |
| firma_cliente    | VARCHAR(255)	       | 259               | URL de S3 para firma.                   |
| evidencia        | VARCHAR(255)	       | 259               | URL de S3 para firma.                   |
| id_reclamo       | UUID       	       | 16                | FK opcional a Gestión de Reclamos       |
| observaciones    | VARCHAR(200)	       | 204               | Campo opcional de haber reclamo         |
| Overhead de fila | -	                   | 23                | Cabecera de fila PostgreSQL       |
| Total por registro | -	               | 838               | Suma de columnas + Overhead   |

#### Tamaño Total - Fórmulas

- Espacio Libre por Bloque = (Tamaño de Bloque - Sobrecarga de Bloque) * Factor = (8 * 1024 - 24) * (0.9) = 7351,2 bytes por bloque
- Cantidad de Filas por Bloque = (Espacio Libre por Bloque) / (Tamaño de Fila + Sobrecarga de Fila) = (7351,2) / (815 + 23) = 8,77 = 9 filas por bloque
- Cantidad de Bloques = Cantidad Total de Filas / Cantidad de Filas por Bloque = 52,416 / 9 = 5824 Bloques
- Tamaño Total = Cantidad de Bloques * Tamaño de Bloque = 5824 * 8 * 1024 = 45,50 Mb

---
### `Reclamo`

#### Configuración de Almacenamiento

| Parámetro                         | Valor                | Justificación                                   |
|----------------------------------|----------------------|-------------------------------------------------|
| Tamaño de bloque (`block_size`)  | 8 KB (8192 bytes)    | Valor por defecto en PostgreSQL compilado       |
| Tamaño de extent inicial         | 64 KB (8 bloques)    | Buen punto de partida para crecimiento moderado |
| Espacio libre reservado (`fillfactor`) | 90% (10% libre) | Aumenta eficiencia de actualizaciones            |

#### Estructura del Registro y Tamaño Lógico:

| Atributo         | Tipo de Dato           | Tamaño (Bytes) | Notas                                                |
|------------------|------------------------|----------------|------------------------------------------------------|
| id_reclamo     | UUID                   | 16             | Identificador principal                              |
| id_entrega     | UUID                   | 16             | Clave foránea a `EventoEntrega`                      |
| id_cliente     | UUID                   | 16             | Clave foránea a `cliente`                            |
| descripcion    | TEXT                   | ~200           | Promedio estimado de 200 caracteres                  |
| fecha_reclamo  | TIMESTAMPTZ            | 8              | Fecha y hora con zona horaria                        |
| estado         | estado_reclamo_enum`  | 4              | Enum interno almacenado como 4 bytes                 |
| tipo_reclamo   | tipo_reclamo_enum`    | 4              | Enum interno almacenado como 4 bytes                 |
| Overhead fila| -                      | 23             | Cabecera interna de PostgreSQL                       |
| Padding     | -                      | 1              | Alineamiento para múltiplos de 8                     |
| **Total por fila** | -                    | **288 bytes**  | Suma aproximada de todos los campos                  |


#### Tamaño Total - Fórmulas

- PProyección de registros al 2028 = 629 reclamos  
- Tamaño del bloque = 8192 bytes  
- Uso efectivo del bloque = 90% → 8192 * 0.9 = 7372.8 bytes  
- Filas por bloque = 7372.8 / 288 ≈ 25 filas  
- Cantidad de bloques requeridos = 629 / 25 ≈ 25.16 → 26 bloques  
- Tamaño total estimado = 26 * 8192 bytes = 213,000 bytes ≈ 208 KB
---